str(datamicro)
#barplots
datamicro %>% ggplot(aes(x=Shannon,y=Group))+
geom_bar(stat = "identity")
#barplots
datamicro %>% ggplot(aes(x=Shannon,y=Group))+
geom_bar(stat = "identity", color="blue", fill="white")
#barplots
datamicro %>% ggplot(aes(x=Shannon,y=Group))+
geom_bar(stat = "identity", color="blue", fill="white")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon))+
geom_bar(stat = "identity", color="blue", fill="white")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon))+
geom_bar(stat = "identity", color="blue")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon))+
geom_bar(stat = "identity")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon))+
geom_bar(stat = "identity",fill="steelblue")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,color=Group))+
geom_bar(stat = "identity",fill="white")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,color=Group))+
geom_bar(stat = "identity")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,color=Group))+
geom_bar(stat = "identity",fill="white")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=Group))+
geom_bar(stat = "identity",fill="white")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=Group))+
geom_bar(stat = "identity")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=Group))+
geom_bar(stat = "identity")+theme_minimal()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=Group))+
geom_bar(stat = "identity")+theme_minimal()+
scale_x_discrete(limits=c("HIV-NAC", "HIV", "NAC"))
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_minimal()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_minimal()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()
# boxplots mas violines con p-values
#group
datamicro %>%
ggplot(mapping = aes(x=Group,y=Shannon, fill=Group))+
geom_violin(trim = FALSE, alpha=0.5)+
geom_boxplot(width=0.3)+ labs(y="Shannon Index",x="")+theme_classic()+
geom_segment(aes(x = 1, y = 6.4, xend = 2, yend = 6.4))+
geom_segment(aes(x = 1, y = 6.3, xend = 1, yend = 6.4))+
geom_segment(aes(x = 2, y = 6.3, xend = 2, yend = 6.4))+
geom_segment(aes(x = 2.05, y = 6.3, xend = 3, yend = 6.3))+
geom_segment(aes(x = 2.05, y = 6.2, xend = 2.05, yend = 6.3))+
geom_segment(aes(x = 3, y = 6.2, xend = 3, yend = 6.3))+
geom_segment(aes(x = 1, y = 6.9, xend = 3, yend = 6.9))+
geom_segment(aes(x = 1, y = 6.9, xend = 1, yend = 6.8))+
geom_segment(aes(x = 3, y = 6.9, xend = 3, yend = 6.8))+
geom_text(aes(x=1.5,y=6.6),label="0.07")+
geom_text(aes(x=2.5,y=6.5),label="0.28")+
geom_text(aes(x=2,y=7.1),label="0.0039")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(color="black",stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(color="black",stat = "identity")+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+ scale_fill_brewer(palette="Blues")
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=factor(Group),y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=factor(Group),y=Shannon,fill=`Time Point`))+
geom_bar(color="black",stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=factor(Group),y=Shannon,fill=factor(`Time Point`)))+
geom_bar(color="black",stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(color="black",stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`,color="black"))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`,colour="black"))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`),color="black")+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,color=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "count", position=position_dodge())+theme_classic()
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_wrap(`Sample Type`~ .)
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>% ggplot(aes(x=Group,y=Shannon,fill=`Sample Type`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Time Point`~ .)
#barplots
datamicro %>%filter(`Sample Type`=="Saline from BAL")
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL")
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Sample Type`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Time Point`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Sample Type`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_wrap(`Time Point`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_wrap(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(color="black",stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity", position=position_dodge())+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(color="black",stat = "identity")+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()+facet_grid(`Sample Type`~ .)
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()+facet_grid(`Sample Type`~ .)
datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
+facet_grid(`Sample Type`~ .)
datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(`Sample Type`~ .)
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(`Sample Type`~ .)
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(`Sample Type`~ .)+
facet_wrap(`Time Point`~ .)
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_wrap(`Time Point`~ .)
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(`Time Point`~ .)
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(`Time Point`~ .)
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(vars(`Sample Type`))
#density plot with facet grid
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()+facet_grid(vars(`Sample Type`),vars(`Time Point`))
#barplots
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Group,y=Shannon,fill=`Time Point`))+
geom_bar(stat = "identity")+theme_classic()+facet_grid(`Sample Type`~ .)
#density plot with facet grid
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
#density plot with facet grid
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs()+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
#density plot with facet grid
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
ggsave(path = "C:\\Users\\LBarrios\\Desktop\\Articulo_micro_colombia\\plots",
width = 7, height = 5, device='tiff', dpi=300,filename = "densitybygroup_timepoint_sampletype.png")
# Density plot with facet grid, 3 variables in one plot
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Group"))+theme_classic()+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
ggsave(path = "C:\\Users\\LBarrios\\Desktop\\Articulo_micro_colombia\\plots",
width = 7, height = 5, device='tiff', dpi=300,filename = "densitybygroup_timepoint_sampletype.png")
# trying new things
# DENSITY FUNCTIONS
datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
datamicro %>%
ggplot(aes(x=Shannon, fill=`Sample Type`))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Sample Type"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
scale_fill_discrete(breaks=c("BAL","Induced Sputum"))
datamicro %>%
ggplot(aes(x=Shannon, fill=`Time Point`))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
#
datamicro %>%
ggplot(aes(x=Shannon))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(Group~ .)
#
datamicro %>%
ggplot(aes(x=Shannon))+
geom_density(alpha=0.6, color="black")+
labs(x="")+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(Group~ .)
#
datamicro %>%
ggplot(aes(x=Shannon))+
geom_density(alpha=0.6, color="black")+
labs()+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
facet_grid(Group~ .)
datamicro %>% ggplot(aes(x=Shannon))+
geom_histogram(color="black",fill="white", alpha=0.5, position="identity")+theme_classic()+
geom_density(alpha=0.6)+
facet_wrap(vars(`Sample Type`),vars(`Time Point`))
datamicro %>% ggplot(aes(x=Shannon))+
geom_histogram(color="black",fill="white", alpha=0.5, position="identity")+theme_classic()+
geom_density(alpha=0.6)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
datamicro %>% ggplot(aes(x=Shannon))+
geom_density(alpha=0.6)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
datamicro %>% ggplot(aes(x=Shannon,fill=Group))+
geom_density(alpha=0.6)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
# Density plot with facet grid, 3 variables in one plot
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Group"))+theme_classic()+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
datamicro %>% ggplot(aes(x=Shannon))+
geom_density(alpha=0.6)+
facet_grid(vars(`Sample Type`),vars(`Time Point`),vars(Group))
datamicro %>% ggplot(aes(x=Shannon))+
geom_density(alpha=0.6)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
datamicro %>% ggplot(aes(x=Shannon,fill=`Sample Type`))+
geom_density(alpha=0.6)+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
datamicro %>% ggplot(aes(x=Shannon,fill=`Sample Type`))+
geom_density(alpha=0.6)+
facet_grid(vars(Group),vars(`Time Point`))
# trying new things
# DENSITY FUNCTIONS
datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
datamicro %>%
ggplot(aes(x=Shannon, fill=`Sample Type`))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Sample Type"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
scale_fill_discrete(breaks=c("BAL","Induced Sputum"))
datamicro %>%
ggplot(aes(x=Shannon, fill=`Time Point`))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
# Density plot with facet grid, 3 variables in one plot
datamicro %>%filter(`Sample Type`!="Saline from BAL") %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Group"))+theme_classic()+
facet_grid(vars(`Sample Type`),vars(`Time Point`))
######################################
########################################
#               data micro             #
########################################
########################################
install.packages("ggpubr")
library(ggpubr)
# trying new things
# DENSITY FUNCTIONS
a<-datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
b<-datamicro %>%
ggplot(aes(x=Shannon, fill=`Sample Type`))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Sample Type"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
scale_fill_discrete(breaks=c("BAL","Induced Sputum"))
c<-datamicro %>%
ggplot(aes(x=Shannon, fill=`Time Point`))+
geom_density(alpha=0.6, color="black")+
labs(x="",y= "Shannon Index")+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
# trying new things
# DENSITY FUNCTIONS
a<-datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs()+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs()+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
# trying new things
# DENSITY FUNCTIONS
a<-datamicro %>%
ggplot(aes(x=Shannon, fill=Group))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Group"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
b<-datamicro %>%
ggplot(aes(x=Shannon, fill=`Sample Type`))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Sample Type"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)+
scale_fill_discrete(breaks=c("BAL","Induced Sputum"))
c<-datamicro %>%
ggplot(aes(x=Shannon, fill=`Time Point`))+
geom_density(alpha=0.6, color="black")+
labs(x="Shannon Index",y="Density")+
guides(fill=guide_legend(title="Time Point"))+theme_classic()+geom_vline(aes(xintercept=mean(Shannon)),
color="black", linetype="dashed", size=0.5)
figure<-ggarrange(a, b, c,
labels = c("A", "B", "C"),
ncol = 2, nrow = 2)
figure
figure
figure<-ggarrange(c, ggarrange(b, a, ncol = 2, labels = c("B", "A")),
nrow = 2,
labels = "C"       # Label of the line plot
)
figure
# CON ggarrange podemos unir los gráficos en uno solo
figure<-ggarrange(c, ggarrange(b, a, ncol = 2, labels = c("B", "A"),common.legend = TRUE, legend = "bottom"),
nrow = 2,
labels = "C"       # Label of the line plot
)
figure
# CON ggarrange podemos unir los gráficos en uno solo
figure<-ggarrange(c, ggarrange(b, a, ncol = 2, labels = c("B", "A"),legend = "bottom"),
nrow = 2,
labels = "C"       # Label of the line plot
)
figure
ggsave(path = "C:\\Users\\LBarrios\\Desktop\\Articulo_micro_colombia\\plots",
width = 7, height = 7, device='tiff', dpi=300,filename = "separated_densitybygroup_timepoint_sampletype.png")
# CON ggarrange podemos unir los gráficos en uno solo
figure<-ggarrange(c, ggarrange(b, a, ncol = 2, labels = c("B", "C"),legend = "bottom"),
nrow = 2,
labels = "A"       # Label of the line plot
)
figure
ggsave(path = "C:\\Users\\LBarrios\\Desktop\\Articulo_micro_colombia\\plots",
width = 7, height = 7, device='tiff', dpi=300,filename = "separated_densitybygroup_timepoint_sampletype.png")
library(psych)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
library(readxl)
library(ggpubr)
